var t,s,e,i,r,a,n,o,h=t=>{throw TypeError(t)},l=(t,s,e)=>s.has(t)||h("Cannot "+e),u=(t,s,e)=>(l(t,s,"read from private field"),e?e.call(t):s.get(t)),c=(t,s,e)=>s.has(t)?h("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(t):s.set(t,e),d=(t,s,e,i)=>(l(t,s,"write to private field"),i?i.call(t,e):s.set(t,e),e),p=(t,s,e)=>(l(t,s,"access private method"),e);import{r as m}from"./vendor-fM8kc8IR.js";import{e as v,s as b,h as f,g as y,n as O,d as g,f as w,i as C}from"./index-C9MSdL1c.js";var M=(o=class extends v{constructor(n,o){super(),c(this,r),c(this,t),c(this,s),c(this,e),c(this,i),d(this,t,n),this.setOptions(o),this.bindMethods(),p(this,r,a).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(s){var i;const r=this.options;this.options=u(this,t).defaultMutationOptions(s),b(this.options,r)||u(this,t).getMutationCache().notify({type:"observerOptionsUpdated",mutation:u(this,e),observer:this}),(null==r?void 0:r.mutationKey)&&this.options.mutationKey&&f(r.mutationKey)!==f(this.options.mutationKey)?this.reset():"pending"===(null==(i=u(this,e))?void 0:i.state.status)&&u(this,e).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||null==(t=u(this,e))||t.removeObserver(this)}onMutationUpdate(t){p(this,r,a).call(this),p(this,r,n).call(this,t)}getCurrentResult(){return u(this,s)}reset(){var t;null==(t=u(this,e))||t.removeObserver(this),d(this,e,void 0),p(this,r,a).call(this),p(this,r,n).call(this)}mutate(s,r){var a;return d(this,i,r),null==(a=u(this,e))||a.removeObserver(this),d(this,e,u(this,t).getMutationCache().build(u(this,t),this.options)),u(this,e).addObserver(this),u(this,e).execute(s)}},t=new WeakMap,s=new WeakMap,e=new WeakMap,i=new WeakMap,r=new WeakSet,a=function(){var t;const i=(null==(t=u(this,e))?void 0:t.state)??y();d(this,s,{...i,isPending:"pending"===i.status,isSuccess:"success"===i.status,isError:"error"===i.status,isIdle:"idle"===i.status,mutate:this.mutate,reset:this.reset})},n=function(e){O.batch(()=>{var r,a,n,o,h,l,c,d;if(u(this,i)&&this.hasListeners()){const m=u(this,s).variables,v=u(this,s).context,b={client:u(this,t),meta:this.options.meta,mutationKey:this.options.mutationKey};if("success"===(null==e?void 0:e.type)){try{null==(a=(r=u(this,i)).onSuccess)||a.call(r,e.data,m,v,b)}catch(p){Promise.reject(p)}try{null==(o=(n=u(this,i)).onSettled)||o.call(n,e.data,null,m,v,b)}catch(p){Promise.reject(p)}}else if("error"===(null==e?void 0:e.type)){try{null==(l=(h=u(this,i)).onError)||l.call(h,e.error,m,v,b)}catch(p){Promise.reject(p)}try{null==(d=(c=u(this,i)).onSettled)||d.call(c,void 0,e.error,m,v,b)}catch(p){Promise.reject(p)}}}this.listeners.forEach(t=>{t(u(this,s))})})},o);function S(t,s){const e=g(),[i]=m.useState(()=>new M(e,t));m.useEffect(()=>{i.setOptions(t)},[i,t]);const r=m.useSyncExternalStore(m.useCallback(t=>i.subscribe(O.batchCalls(t)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),a=m.useCallback((t,s)=>{i.mutate(t,s).catch(w)},[i]);if(r.error&&C(i.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:a,mutateAsync:r.mutate}}export{S as u};
