import{j as e,i as s,W as a,c as t,m as r,aC as l,aE as i,aF as n,aG as d,aH as c,ac as o,ay as x,X as m,A as p,aI as h,aJ as u,aK as j}from"./ui-CW4SeC5O.js";import{r as y}from"./vendor-fM8kc8IR.js";import{u as g}from"./useQuery-FleDKwgl.js";import{u as N}from"./useMutation-CLlNb6S2.js";import{D as b}from"./DashboardLayout-CZopp9XZ.js";import{u as f,c as v,L as w,B as C}from"./index-C9MSdL1c.js";import{C as R}from"./Card-BAQzvENO.js";import{K as k,L as S,M as A}from"./api-Cz4wYYaF.js";import"./constants-CTD2yw_V.js";const q=()=>{const q=f(),[E,z]=y.useState("dashboard"),[F,P]=y.useState("todos"),[_,D]=y.useState(""),[I,L]=y.useState(null),[G,T]=y.useState(""),[K,M]=y.useState(""),[B,H]=y.useState(!1),{data:J,isLoading:Q,refetch:U}=g({queryKey:["sentiments",F,_],queryFn:()=>S({sentimiento:"todos"===F?void 0:F,search:_||void 0,limit:100})}),{data:V,isLoading:W}=g({queryKey:["sentimentStats"],queryFn:A}),[O,X]=y.useState(null),Y=N({mutationFn:k,onSuccess:e=>{if(X(null),e.success&&e.data)M(e.data.respuesta),q.success("Respuesta generada exitosamente");else{const s=e.error||"Error al generar respuesta";X(s),q.error("Error al generar respuesta")}},onError:e=>{const s=e.message||"Error de conexión con la API de IA";X(s),q.error("Error de conexión")}}),Z=(null==J?void 0:J.data)||[],$=null==V?void 0:V.data,ee=s=>{switch(s){case"positivo":return e.jsx(i,{className:"w-4 h-4 text-green-500"});case"negativo":return e.jsx(n,{className:"w-4 h-4 text-red-500"});default:return e.jsx(d,{className:"w-4 h-4 text-gray-500"})}},se=e=>{switch(e){case"positivo":return"bg-green-100 text-green-800 border-green-200";case"negativo":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},ae=e=>{const s=(null==e?void 0:e.toLowerCase())||"";return s.includes("alto")||s.includes("high")?"bg-red-100 text-red-800":s.includes("medio")||s.includes("medium")?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"};return e.jsxs(b,{title:"Analisis de Sentimientos",children:[e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsxs("button",{onClick:()=>z("dashboard"),className:v("px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2","dashboard"===E?"bg-primary-600 text-white":"bg-white text-secondary-600 hover:bg-secondary-100"),children:[e.jsx(s,{className:"w-4 h-4"}),"Dashboard"]}),e.jsxs("button",{onClick:()=>z("responder"),className:v("px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2","responder"===E?"bg-primary-600 text-white":"bg-white text-secondary-600 hover:bg-secondary-100"),children:[e.jsx(a,{className:"w-4 h-4"}),"Responder con IA"]})]}),e.jsx(t,{mode:"wait",children:"dashboard"===E?e.jsxs(r.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs(R,{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-blue-100",children:e.jsx(l,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-secondary-500",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold text-secondary-900",children:W?"...":(null==$?void 0:$.total)||0})]})]}),e.jsxs(R,{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-green-100",children:e.jsx(i,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-secondary-500",children:"Positivos"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:W?"...":(null==$?void 0:$.positivos)||0})]})]}),e.jsxs(R,{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-red-100",children:e.jsx(n,{className:"w-6 h-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-secondary-500",children:"Negativos"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:W?"...":(null==$?void 0:$.negativos)||0})]})]}),e.jsxs(R,{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gray-100",children:e.jsx(d,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-secondary-500",children:"Neutros"}),e.jsx("p",{className:"text-2xl font-bold text-gray-600",children:W?"...":(null==$?void 0:$.neutros)||0})]})]})]}),e.jsx(R,{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{className:"w-5 h-5 text-secondary-500"}),e.jsx("span",{className:"font-medium text-secondary-700",children:"Filtrar por:"}),e.jsx("div",{className:"flex gap-2",children:["todos","positivo","negativo","neutro"].map(s=>e.jsx("button",{onClick:()=>P(s),className:v("px-3 py-1 rounded-full text-sm font-medium transition-all capitalize",F===s?"bg-primary-600 text-white":"bg-secondary-100 text-secondary-600 hover:bg-secondary-200"),children:s},s))})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[e.jsxs("div",{className:"relative flex-1 md:w-64",children:[e.jsx(o,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-secondary-400"}),e.jsx("input",{type:"text",placeholder:"Buscar comentarios...",value:_,onChange:e=>D(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-secondary-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsx("button",{onClick:()=>U(),className:"p-2 rounded-lg hover:bg-secondary-100 transition-colors",title:"Actualizar",children:e.jsx(x,{className:"w-5 h-5 text-secondary-600"})})]})]})}),e.jsxs(R,{children:[e.jsxs("h3",{className:"text-lg font-bold text-secondary-900 mb-4",children:["Comentarios (",Z.length,")"]}),Q?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(w,{size:"lg"})}):0===Z.length?e.jsx("div",{className:"text-center py-8 text-secondary-500",children:"No hay comentarios para mostrar"}):e.jsx("div",{className:"space-y-3 max-h-[600px] overflow-y-auto",children:Z.map((s,t)=>e.jsx(r.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.02*t},className:"p-4 border border-secondary-200 rounded-lg hover:border-primary-300 transition-colors cursor-pointer",onClick:()=>L(s),children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-medium text-secondary-900",children:s.Autor||"Anonimo"}),s.Responde_A&&e.jsxs("span",{className:"text-xs text-secondary-500",children:["responde a ",s.Responde_A]})]}),e.jsx("p",{className:"text-secondary-700 line-clamp-2",children:s.Comentario}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:[e.jsxs("span",{className:v("inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium border",se(s.Sentimiento)),children:[ee(s.Sentimiento),s.Sentimiento]}),s.Categoria&&e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs bg-blue-100 text-blue-800",children:s.Categoria}),s.Nivel_Riesgo&&e.jsxs("span",{className:v("px-2 py-0.5 rounded-full text-xs",ae(s.Nivel_Riesgo)),children:["Riesgo: ",s.Nivel_Riesgo]})]})]}),e.jsx(C,{size:"sm",variant:"ghost",onClick:e=>{e.stopPropagation(),T(s.Comentario),z("responder")},children:e.jsx(a,{className:"w-4 h-4"})})]})},s.ID||t))})]}),e.jsx(t,{children:I&&e.jsx(r.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>L(null),children:e.jsx(r.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-secondary-900",children:"Detalle del Comentario"}),e.jsx("button",{onClick:()=>L(null),className:"p-2 hover:bg-secondary-100 rounded-lg",children:e.jsx(m,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-secondary-500",children:"Autor"}),e.jsx("p",{className:"text-secondary-900",children:I.Autor||"Anonimo"})]}),I.Responde_A&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-secondary-500",children:"Responde a"}),e.jsx("p",{className:"text-secondary-900",children:I.Responde_A})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-secondary-500",children:"Comentario"}),e.jsx("p",{className:"text-secondary-900 bg-secondary-50 p-3 rounded-lg",children:I.Comentario})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-secondary-500",children:"Sentimiento"}),e.jsxs("p",{className:v("inline-flex items-center gap-1 px-2 py-1 rounded-full text-sm",se(I.Sentimiento)),children:[ee(I.Sentimiento),I.Sentimiento]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-secondary-500",children:"Nivel de Riesgo"}),e.jsx("p",{className:v("inline-block px-2 py-1 rounded-full text-sm",ae(I.Nivel_Riesgo)),children:I.Nivel_Riesgo||"No especificado"})]})]}),I.Tema&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-secondary-500",children:"Tema"}),e.jsx("p",{className:"text-secondary-900",children:I.Tema})]}),I.Categoria&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-secondary-500",children:"Categoria"}),e.jsx("p",{className:"text-secondary-900",children:I.Categoria})]}),I.Etiquetas&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-secondary-500",children:"Etiquetas"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:I.Etiquetas.split(",").map((s,a)=>e.jsx("span",{className:"px-2 py-0.5 bg-secondary-100 text-secondary-700 rounded-full text-xs",children:s.trim()},a))})]}),I.Detalle&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-secondary-500",children:"Detalle"}),e.jsx("p",{className:"text-secondary-700 text-sm",children:I.Detalle})]}),e.jsxs("div",{className:"pt-4 border-t flex justify-end gap-2",children:[e.jsx(C,{variant:"secondary",onClick:()=>L(null),children:"Cerrar"}),e.jsxs(C,{onClick:()=>{T(I.Comentario),L(null),z("responder")},children:[e.jsx(a,{className:"w-4 h-4 mr-2"}),"Generar Respuesta"]})]})]})]})})})})]},"dashboard"):e.jsxs(r.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-6",children:[e.jsxs(R,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(a,{className:"w-6 h-6 text-primary-600"}),e.jsx("h3",{className:"text-lg font-bold text-secondary-900",children:"Generador de Respuestas con IA"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(p,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"Como usar esta herramienta:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[e.jsx("li",{children:"Copia el comentario de Facebook que deseas responder"}),e.jsx("li",{children:"Pegalo en el campo de texto de abajo"}),e.jsx("li",{children:'Haz clic en "Generar Respuesta"'}),e.jsx("li",{children:"Revisa y copia la respuesta generada"})]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-2",children:"Comentario a responder"}),e.jsx("textarea",{value:G,onChange:e=>T(e.target.value),placeholder:"Pega aqui el comentario de Facebook que deseas responder...",className:"w-full px-4 py-3 border border-secondary-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 min-h-[120px] resize-y"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(C,{variant:"secondary",onClick:()=>{T(""),M(""),X(null)},disabled:Y.isPending,children:"Limpiar"}),e.jsx(C,{onClick:()=>{G.trim()?Y.mutate({comentario:G,tono:"profesional"}):q.error("Ingresa un comentario para responder")},disabled:!G.trim()||Y.isPending,children:Y.isPending?e.jsxs(e.Fragment,{children:[e.jsx(w,{size:"sm",className:"mr-2"}),"Generando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"w-4 h-4 mr-2"}),"Generar Respuesta"]})})]}),O&&e.jsx(r.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(m,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-red-800",children:"Error al generar respuesta"}),e.jsx("p",{className:"text-sm text-red-700 mt-1 break-all",children:O}),e.jsx("p",{className:"text-xs text-red-600 mt-2",children:"Verifica que el backend tenga el modelo correcto: gemini-2.0-flash-lite"})]})]})})]})]}),e.jsx(t,{children:K&&e.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:e.jsxs(R,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{className:"w-5 h-5 text-green-600"}),e.jsx("h4",{className:"font-bold text-secondary-900",children:"Respuesta Sugerida"})]}),e.jsx(C,{size:"sm",variant:B?"primary":"secondary",onClick:async()=>{K&&(await navigator.clipboard.writeText(K),H(!0),q.success("Respuesta copiada al portapapeles"),setTimeout(()=>H(!1),2e3))},children:B?e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"w-4 h-4 mr-1"}),"Copiado"]}):e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-4 h-4 mr-1"}),"Copiar"]})})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsx("p",{className:"text-secondary-800 whitespace-pre-wrap",children:K})}),e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsx("p",{className:"text-xs text-secondary-500",children:"Esta respuesta fue generada por IA basada en el contexto de la campana. Revisala antes de publicarla y ajustala segun sea necesario."})})]})})}),e.jsxs(R,{className:"bg-secondary-50",children:[e.jsx("h4",{className:"font-medium text-secondary-900 mb-3",children:"Consejos para responder comentarios"}),e.jsxs("ul",{className:"space-y-2 text-sm text-secondary-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-primary-600 font-bold",children:"1."}),"Mantén un tono profesional y respetuoso siempre"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-primary-600 font-bold",children:"2."}),"No respondas a provocaciones o ataques personales"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-primary-600 font-bold",children:"3."}),"Usa datos y hechos para respaldar tus argumentos"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-primary-600 font-bold",children:"4."}),"Redirige la conversación hacia las propuestas de campana"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-primary-600 font-bold",children:"5."}),"Revisa y personaliza la respuesta antes de publicar"]})]})]})]},"responder")})]})};export{q as default};
