import{j as e,u as s,ac as a,ap as r,r as t,m as l,z as n,M as o,Q as i,as as c,ad as d,a as m,b as x,at as h}from"./ui-BChFafQN.js";import{r as u}from"./vendor-fM8kc8IR.js";import{u as j}from"./useQuery-BWIQYHUH.js";import{d as p,u as v,I as g,B as f,T as N}from"./index-CVZ54knL.js";import{u as y}from"./useMutation-B2sarHY-.js";import{D as b}from"./DashboardLayout-C2CvQ_Yq.js";import{C as w}from"./Card-BeU1eMaR.js";import{B as C}from"./Badge-CFDGoBCM.js";import{M as E}from"./Modal-i9STTiHO.js";import{D,E as F,F as z,G as L}from"./api-Cz4wYYaF.js";import{a as I}from"./helpers-7IRBxzvX.js";import"./constants-A1-OgdCM.js";const P="dra.mirella.camapaza.4@gmail.com",T=`https://calendar.google.com/calendar/embed?src=${encodeURIComponent(P)}&ctz=America/Lima&mode=AGENDA&showTitle=0&showNav=1&showDate=1&showPrint=0&showTabs=1&showCalendars=0&showTz=0`,k=`https://calendar.google.com/calendar/u/0?cid=${btoa(P)}`,S=()=>{const[P,S]=u.useState(""),[q,A]=u.useState(""),[G,M]=u.useState(!1),[R,B]=u.useState(null),[H,Q]=u.useState({titulo:"",descripcion:"",fecha:"",hora:"",lugar:"",responsable:""}),K=p(),J=v(),{data:$,isLoading:O}=j({queryKey:["events",q],queryFn:()=>L({estado:q||void 0})}),U=y({mutationFn:F,onSuccess:()=>{J.success("Evento creado correctamente"),K.invalidateQueries({queryKey:["events"]}),X()},onError:()=>{J.error("Error al crear evento")}}),_=y({mutationFn:({id:e,data:s})=>z(e,s),onSuccess:()=>{J.success("Evento actualizado correctamente"),K.invalidateQueries({queryKey:["events"]}),X()},onError:()=>{J.error("Error al actualizar evento")}}),V=y({mutationFn:D,onSuccess:()=>{J.success("Evento eliminado"),K.invalidateQueries({queryKey:["events"]})},onError:()=>{J.error("Error al eliminar evento")}}),W=e=>{var s;e?(B(e),Q({titulo:e.Titulo,descripcion:e.Descripcion||"",fecha:(null==(s=e.Fecha)?void 0:s.split("T")[0])||"",hora:e.Hora||"",lugar:e.Lugar||"",responsable:e.Responsable||""})):(B(null),Q({titulo:"",descripcion:"",fecha:"",hora:"",lugar:"",responsable:""})),M(!0)},X=()=>{M(!1),B(null),Q({titulo:"",descripcion:"",fecha:"",hora:"",lugar:"",responsable:""})},Y=(e,s)=>{_.mutate({id:e,data:{Estado:s}})},Z=((null==$?void 0:$.data)||[]).filter(e=>{var s;return e.Titulo.toLowerCase().includes(P.toLowerCase())||(null==(s=e.Lugar)?void 0:s.toLowerCase().includes(P.toLowerCase()))}),ee=a=>{switch(a){case"Programado":default:return e.jsx(s,{className:"w-4 h-4"});case"EnCurso":return e.jsx(h,{className:"w-4 h-4"});case"Finalizado":return e.jsx(x,{className:"w-4 h-4"});case"Cancelado":return e.jsx(m,{className:"w-4 h-4"})}},se=e=>new Date(e)>=new Date,ae=Z.filter(e=>se(e.Fecha)&&"Cancelado"!==e.Estado),re=Z.filter(e=>!se(e.Fecha)||"Cancelado"===e.Estado);return e.jsxs(b,{title:"Eventos",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center",children:e.jsx(s,{className:"w-6 h-6 text-primary-600"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-secondary-900",children:[ae.length," Eventos Próximos"]}),e.jsx("p",{className:"text-sm text-secondary-500",children:"Gestiona los eventos de la campaña"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(g,{placeholder:"Buscar eventos...",value:P,onChange:e=>S(e.target.value),leftIcon:e.jsx(a,{className:"w-5 h-5"}),className:"w-48"}),e.jsxs("select",{value:q,onChange:e=>A(e.target.value),className:"px-4 py-2 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"Programado",children:"Programados"}),e.jsx("option",{value:"EnCurso",children:"En Curso"}),e.jsx("option",{value:"Finalizado",children:"Finalizados"}),e.jsx("option",{value:"Cancelado",children:"Cancelados"})]}),e.jsx(f,{variant:"primary",leftIcon:e.jsx(r,{className:"w-4 h-4"}),onClick:()=>W(),children:"Nuevo Evento"})]})]}),e.jsxs(w,{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(s,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-secondary-900",children:"Agenda de la Candidata"}),e.jsx("p",{className:"text-sm text-secondary-500",children:"Calendario sincronizado con Google Calendar"})]})]}),e.jsxs("a",{href:k,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-primary-600 hover:text-primary-700",children:[e.jsx("span",{children:"Abrir en Google Calendar"}),e.jsx(t,{className:"w-4 h-4"})]})]}),e.jsx("div",{className:"rounded-lg overflow-hidden border border-secondary-200",children:e.jsx("iframe",{src:T,style:{border:0,overflow:"hidden"},width:"100%",height:"400",title:"Agenda de la Dra. Mirella Camapaza"})})]}),O?e.jsx("div",{className:"text-center py-12 text-secondary-500",children:"Cargando eventos..."}):0===Z.length?e.jsxs(w,{className:"text-center py-12",children:[e.jsx(s,{className:"w-16 h-16 mx-auto text-secondary-300 mb-4"}),e.jsx("p",{className:"text-secondary-500",children:"No hay eventos registrados"}),e.jsx(f,{variant:"primary",className:"mt-4",leftIcon:e.jsx(r,{className:"w-4 h-4"}),onClick:()=>W(),children:"Crear Primer Evento"})]}):e.jsxs("div",{className:"space-y-8",children:[ae.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-secondary-900 mb-4",children:"Próximos Eventos"}),e.jsx("div",{className:"space-y-4",children:ae.map((s,a)=>e.jsx(l.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*a},children:e.jsx(w,{className:"hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[e.jsxs("div",{className:"flex-shrink-0 w-20 h-20 bg-primary-100 rounded-lg flex flex-col items-center justify-center",children:[e.jsx("span",{className:"text-2xl font-bold text-primary-600",children:new Date(s.Fecha).getDate()}),e.jsx("span",{className:"text-xs text-primary-600 uppercase",children:new Date(s.Fecha).toLocaleDateString("es-PE",{month:"short"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-secondary-900",children:s.Titulo}),e.jsx("p",{className:"text-secondary-600 text-sm mt-1",children:s.Descripcion})]}),e.jsxs(C,{className:I(s.Estado),children:[ee(s.Estado),e.jsx("span",{className:"ml-1",children:s.Estado})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mt-3 text-sm text-secondary-500",children:[s.Hora&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(n,{className:"w-4 h-4"}),e.jsx("span",{children:s.Hora})]}),s.Lugar&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(o,{className:"w-4 h-4"}),e.jsx("span",{children:s.Lugar})]}),s.Responsable&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(i,{className:"w-4 h-4"}),e.jsx("span",{children:s.Responsable})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:["Programado"===s.Estado&&e.jsx(f,{variant:"success",size:"sm",onClick:()=>Y(s.ID,"EnCurso"),children:"Iniciar"}),"EnCurso"===s.Estado&&e.jsx(f,{variant:"outline",size:"sm",onClick:()=>Y(s.ID,"Finalizado"),children:"Finalizar"}),e.jsx("button",{onClick:()=>W(s),className:"p-2 text-secondary-600 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",title:"Editar",children:e.jsx(c,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{confirm("¿Estás seguro de eliminar este evento?")&&V.mutate(s.ID)},className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar",children:e.jsx(d,{className:"w-4 h-4"})})]})]})})},s.ID))})]}),re.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-secondary-700 mb-4",children:"Eventos Pasados / Cancelados"}),e.jsx("div",{className:"space-y-3",children:re.map(s=>e.jsx(w,{className:"bg-secondary-50 opacity-75",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-12 h-12 bg-secondary-200 rounded-lg flex flex-col items-center justify-center",children:[e.jsx("span",{className:"text-sm font-bold text-secondary-600",children:new Date(s.Fecha).getDate()}),e.jsx("span",{className:"text-xs text-secondary-500 uppercase",children:new Date(s.Fecha).toLocaleDateString("es-PE",{month:"short"})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-secondary-700",children:s.Titulo}),e.jsx("p",{className:"text-sm text-secondary-500",children:s.Lugar})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:I(s.Estado),size:"sm",children:s.Estado}),e.jsx("button",{onClick:()=>V.mutate(s.ID),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar",children:e.jsx(d,{className:"w-4 h-4"})})]})]})},s.ID))})]})]}),e.jsx(E,{isOpen:G,onClose:X,title:R?"Editar Evento":"Nuevo Evento",size:"lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(g,{label:"Título del evento",placeholder:"Ej: Mitin Central en Juliaca",value:H.titulo,onChange:e=>Q({...H,titulo:e.target.value}),required:!0}),e.jsx(N,{label:"Descripción",placeholder:"Describe el evento...",value:H.descripcion,onChange:e=>Q({...H,descripcion:e.target.value}),rows:3}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(g,{label:"Fecha",type:"date",value:H.fecha,onChange:e=>Q({...H,fecha:e.target.value}),required:!0}),e.jsx(g,{label:"Hora",type:"time",value:H.hora,onChange:e=>Q({...H,hora:e.target.value})})]}),e.jsx(g,{label:"Lugar",placeholder:"Ej: Plaza de Armas de Juliaca",value:H.lugar,onChange:e=>Q({...H,lugar:e.target.value}),leftIcon:e.jsx(o,{className:"w-5 h-5"})}),e.jsx(g,{label:"Responsable",placeholder:"Nombre del encargado",value:H.responsable,onChange:e=>Q({...H,responsable:e.target.value}),leftIcon:e.jsx(i,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(f,{variant:"ghost",onClick:X,children:"Cancelar"}),e.jsx(f,{variant:"primary",onClick:()=>{H.titulo.trim()&&H.fecha?R?_.mutate({id:R.ID,data:{Titulo:H.titulo,Descripcion:H.descripcion,Fecha:H.fecha,Hora:H.hora,Lugar:H.lugar,Responsable:H.responsable}}):U.mutate({titulo:H.titulo,descripcion:H.descripcion,fecha:H.fecha,hora:H.hora,lugar:H.lugar,responsable:H.responsable}):J.error("El título y la fecha son requeridos")},isLoading:U.isPending||_.isPending,children:R?"Guardar Cambios":"Crear Evento"})]})]})})]})};export{S as default};
