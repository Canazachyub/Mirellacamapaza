import{j as e,aw as a,x as s,$ as n,S as l,ax as r,ay as i,m as t,az as c,y as o,aA as d}from"./ui-CW4SeC5O.js";import{r as m}from"./vendor-fM8kc8IR.js";import{u as x}from"./useQuery-FleDKwgl.js";import{d as h,u as p,I as j,T as u,B as g}from"./index-C9MSdL1c.js";import{u as f}from"./useMutation-CLlNb6S2.js";import{D as b}from"./DashboardLayout-CZopp9XZ.js";import{C as y}from"./Card-BAQzvENO.js";import{B as v}from"./Badge-Di74LEph.js";import{H as N,I as w,J as C}from"./api-Cz4wYYaF.js";import{C as k,b as P,R as I}from"./constants-CTD2yw_V.js";const A=()=>{const[A,S]=m.useState("general"),[E,G]=m.useState({}),[L,D]=m.useState("checking"),M=h(),T=p(),{data:z,isLoading:R}=x({queryKey:["config"],queryFn:C}),B=f({mutationFn:({key:e,value:a,description:s})=>w(e,a,s),onSuccess:()=>{T.success("Configuración guardada"),M.invalidateQueries({queryKey:["config"]})},onError:()=>{T.error("Error al guardar configuración")}});m.useEffect(()=>{(async()=>{try{await N(),D("online")}catch{D("offline")}})()},[]),m.useEffect(()=>{if(null==z?void 0:z.data){const e={};Object.entries(z.data).forEach(([a,s])=>{"object"==typeof s&&null!==s&&"value"in s?e[a]=s.value:"string"==typeof s&&(e[a]=s)}),G(e)}},[z]);const q=(e,a)=>{void 0!==E[e]&&B.mutate({key:e,value:E[e],description:a})},F=[{id:"general",label:"General",icon:a},{id:"contact",label:"Contacto",icon:s},{id:"social",label:"Redes Sociales",icon:n},{id:"security",label:"Seguridad",icon:l},{id:"api",label:"API",icon:r}];return e.jsx(b,{title:"Configuración",children:e.jsxs("div",{className:"grid lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(y,{padding:"sm",children:e.jsx("nav",{className:"space-y-1",children:F.map(a=>{const s=a.icon;return e.jsxs("button",{onClick:()=>S(a.id),className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-colors "+(A===a.id?"bg-primary-50 text-primary-600":"text-secondary-600 hover:bg-secondary-50"),children:[e.jsx(s,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:a.label})]},a.id)})})})}),e.jsx("div",{className:"lg:col-span-3",children:R?e.jsxs(y,{className:"text-center py-12",children:[e.jsx(i,{className:"w-8 h-8 text-secondary-400 mx-auto animate-spin"}),e.jsx("p",{className:"text-secondary-500 mt-4",children:"Cargando configuración..."})]}):e.jsxs(t.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:["general"===A&&e.jsxs(y,{children:[e.jsx("h3",{className:"text-lg font-semibold text-secondary-900 mb-6",children:"Configuración General"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-secondary-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-secondary-900 mb-4",children:"Información de la Candidata"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-secondary-500",children:"Nombre:"}),e.jsx("span",{className:"ml-2 font-medium",children:k.nombreCompleto})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-secondary-500",children:"Partido:"}),e.jsx("span",{className:"ml-2 font-medium",children:k.partido})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-secondary-500",children:"Número de Lista:"}),e.jsx("span",{className:"ml-2 font-medium",children:k.numeroLista})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-secondary-500",children:"Región:"}),e.jsx("span",{className:"ml-2 font-medium",children:k.region})]})]})]}),e.jsx(j,{label:"Título del Sitio",value:E.siteTitle||"Dra. Mirella Camapaza - Candidata a Diputada",onChange:e=>G({...E,siteTitle:e.target.value}),helperText:"Este título aparece en la pestaña del navegador"}),e.jsx(u,{label:"Descripción del Sitio",value:E.siteDescription||k.slogan,onChange:e=>G({...E,siteDescription:e.target.value}),rows:3,helperText:"Esta descripción aparece en los resultados de búsqueda"}),e.jsx("div",{className:"flex justify-end",children:e.jsx(g,{variant:"primary",leftIcon:e.jsx(c,{className:"w-4 h-4"}),onClick:()=>q("siteTitle"),isLoading:B.isPending,children:"Guardar Cambios"})})]})]}),"contact"===A&&e.jsxs(y,{children:[e.jsx("h3",{className:"text-lg font-semibold text-secondary-900 mb-6",children:"Información de Contacto"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(j,{label:"WhatsApp",value:E.whatsapp||P.whatsapp,onChange:e=>G({...E,whatsapp:e.target.value}),leftIcon:e.jsx(s,{className:"w-5 h-5"}),helperText:"Número sin espacios ni guiones (ej: 51964271720)"}),e.jsx(j,{label:"Correo Electrónico",type:"email",value:E.email||P.email,onChange:e=>G({...E,email:e.target.value}),leftIcon:e.jsx(o,{className:"w-5 h-5"})}),e.jsx(u,{label:"Mensaje de WhatsApp Predeterminado",value:E.whatsappMessage||P.whatsappMessage,onChange:e=>G({...E,whatsappMessage:e.target.value}),rows:2,helperText:"Este mensaje se pre-carga cuando alguien hace clic en el botón de WhatsApp"}),e.jsx("div",{className:"flex justify-end",children:e.jsx(g,{variant:"primary",leftIcon:e.jsx(c,{className:"w-4 h-4"}),onClick:()=>q("whatsapp"),isLoading:B.isPending,children:"Guardar Cambios"})})]})]}),"social"===A&&e.jsxs(y,{children:[e.jsx("h3",{className:"text-lg font-semibold text-secondary-900 mb-6",children:"Redes Sociales"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(j,{label:"Facebook",value:E.facebook||I.facebook.url,onChange:e=>G({...E,facebook:e.target.value}),placeholder:"https://facebook.com/..."}),e.jsx(j,{label:"Instagram",value:E.instagram||I.instagram.url,onChange:e=>G({...E,instagram:e.target.value}),placeholder:"https://instagram.com/..."}),e.jsx(j,{label:"TikTok",value:E.tiktok||I.tiktok.url,onChange:e=>G({...E,tiktok:e.target.value}),placeholder:"https://tiktok.com/..."}),e.jsx(j,{label:"Grupo de WhatsApp",value:E.whatsappGroup||I.whatsappGrupo.url,onChange:e=>G({...E,whatsappGroup:e.target.value}),placeholder:"https://chat.whatsapp.com/..."}),e.jsx("div",{className:"flex justify-end",children:e.jsx(g,{variant:"primary",leftIcon:e.jsx(c,{className:"w-4 h-4"}),onClick:()=>q("facebook"),isLoading:B.isPending,children:"Guardar Cambios"})})]})]}),"security"===A&&e.jsxs(y,{children:[e.jsx("h3",{className:"text-lg font-semibold text-secondary-900 mb-6",children:"Seguridad"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(l,{className:"w-5 h-5 text-amber-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-amber-800",children:"Cambiar Contraseña del Panel"}),e.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"La contraseña se almacena en la hoja de Configuración de Google Sheets. Para cambiarla, actualiza el valor de ADMIN_PASSWORD directamente en la hoja."})]})]})}),e.jsx(j,{label:"Nueva Contraseña",type:"password",value:E.newPassword||"",onChange:e=>G({...E,newPassword:e.target.value}),leftIcon:e.jsx(d,{className:"w-5 h-5"}),helperText:"Mínimo 8 caracteres"}),e.jsx(j,{label:"Confirmar Contraseña",type:"password",value:E.confirmPassword||"",onChange:e=>G({...E,confirmPassword:e.target.value}),leftIcon:e.jsx(d,{className:"w-5 h-5"})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(g,{variant:"primary",leftIcon:e.jsx(c,{className:"w-4 h-4"}),onClick:()=>{E.newPassword===E.confirmPassword?E.newPassword&&E.newPassword.length<8?T.error("La contraseña debe tener al menos 8 caracteres"):q("ADMIN_PASSWORD"):T.error("Las contraseñas no coinciden")},isLoading:B.isPending,disabled:!E.newPassword||!E.confirmPassword,children:"Cambiar Contraseña"})})]})]}),"api"===A&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(y,{children:[e.jsx("h3",{className:"text-lg font-semibold text-secondary-900 mb-6",children:"Estado de la API"}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-secondary-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r,{className:"w-6 h-6 text-secondary-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-secondary-900",children:"Google Apps Script API"}),e.jsx("p",{className:"text-sm text-secondary-500",children:"Backend de la aplicación"})]})]}),e.jsxs(v,{variant:"online"===L?"success":"offline"===L?"danger":"default",size:"lg",children:["checking"===L&&"Verificando...","online"===L&&"En línea","offline"===L&&"Sin conexión"]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(g,{variant:"outline",leftIcon:e.jsx(i,{className:"w-4 h-4"}),onClick:async()=>{D("checking");try{await N(),D("online"),T.success("API funcionando correctamente")}catch{D("offline"),T.error("No se pudo conectar con la API")}},children:"Verificar Conexión"})})]}),e.jsxs(y,{children:[e.jsx("h3",{className:"text-lg font-semibold text-secondary-900 mb-6",children:"URLs de Recursos"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-secondary-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-secondary-500 mb-1",children:"Google Spreadsheet ID"}),e.jsx("p",{className:"font-mono text-sm text-secondary-900 break-all",children:"1bPkTQFf8LGnnEtddu6_9jnsgFKPJ1gkdOqov8lgPLho"})]}),e.jsxs("div",{className:"p-4 bg-secondary-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-secondary-500 mb-1",children:"Google Drive Folder ID"}),e.jsx("p",{className:"font-mono text-sm text-secondary-900 break-all",children:"1hqMByYLDMgMEw_AG_cqb1EpBsWeBEY1l"})]}),e.jsxs("div",{className:"p-4 bg-secondary-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-secondary-500 mb-1",children:"API URL"}),e.jsx("p",{className:"font-mono text-sm text-secondary-900 break-all",children:"https://script.google.com/macros/s/AKfycbzKLcr0Ig6zpMBdplm5_zGidxzxy5fAEuC4l9teM2dTlYbbjVODh3GhhoOAEsG7vIpkfA/exec"})]})]})]})]})]},A)})]})})};export{A as default};
